<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××¢×‘×™×¨ ×œ×¡×•×›×Ÿ...</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #0a0a2e 0%, #1a1a4e 30%, #2d1b69 60%, #1a0a3e 100%);
            color: #fff; direction: rtl;
        }
        .card {
            background: rgba(255,255,255,0.06);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 24px; padding: 45px 30px;
            box-shadow: 0 25px 60px rgba(0,0,0,0.4);
            text-align: center; max-width: 420px; width: 90%;
        }
        .emoji { font-size: 52px; margin-bottom: 12px; }
        .name {
            font-size: 24px; font-weight: 700; margin-bottom: 4px;
            background: linear-gradient(90deg, #a78bfa, #818cf8, #6366f1);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
        }
        .subtitle { font-size: 15px; color: rgba(255,255,255,0.5); margin-bottom: 25px; }

        /* Auto-redirect state */
        .auto-state { margin-bottom: 20px; }
        .spinner {
            width: 44px; height: 44px;
            border: 3px solid rgba(255,255,255,0.1); border-top: 3px solid #818cf8;
            border-radius: 50%; animation: spin 0.8s linear infinite; margin: 0 auto 15px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .auto-text { font-size: 16px; color: rgba(255,255,255,0.7); animation: pulse 1.5s ease-in-out infinite; }
        @keyframes pulse { 0%,100% { opacity: 0.5; } 50% { opacity: 1; } }

        /* Buttons state */
        .buttons-state { display: none; }
        .desc { font-size: 15px; color: rgba(255,255,255,0.6); margin-bottom: 22px; line-height: 1.5; }

        .btn-main {
            display: inline-block; width: 85%; padding: 16px 20px; font-size: 17px;
            font-weight: 700; color: #fff; text-decoration: none;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-radius: 14px; box-shadow: 0 8px 25px rgba(99,102,241,0.4);
            font-family: inherit; transition: transform 0.15s;
        }
        .btn-main:active { transform: scale(0.97); }

        .btn-secondary {
            display: inline-block; width: 85%; margin-top: 12px; padding: 13px 20px;
            font-size: 14px; font-weight: 500; color: #a78bfa; text-decoration: none;
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(167,139,250,0.3);
            border-radius: 12px; font-family: inherit;
        }
        .btn-secondary:active { transform: scale(0.97); }

        .tip { margin-top: 18px; font-size: 12px; color: rgba(255,255,255,0.3); line-height: 1.6; }
        .error { color: #f87171; }
    </style>
</head>
<body>
    <div class="card">
        <div id="main">
            <div class="emoji" id="emoji">ğŸ¤–</div>
            <div class="name" id="name">×¡×•×›×Ÿ AI</div>
            <div class="subtitle" id="subtitle"></div>

            <!-- Auto-redirect state (shown first) -->
            <div class="auto-state" id="auto-state">
                <div class="spinner"></div>
                <div class="auto-text">...×¤×•×ª×— ××ª ×”×¡×•×›×Ÿ</div>
            </div>

            <!-- Manual buttons state (shown as fallback) -->
            <div class="buttons-state" id="buttons-state">
                <div class="desc" id="desc"></div>

                <a class="btn-main" id="btn-main" href="#">ğŸš€ ×¤×ª×— ××ª ×”×¡×•×›×Ÿ</a>
                <br>
                <a class="btn-secondary" id="btn-alt" href="#">×¤×ª×— ×‘×“×¨×š ××—×¨×ª</a>

                <div class="tip" id="tip"></div>
            </div>
        </div>
        <div id="err" style="display:none">
            <div class="emoji">ğŸ˜•</div>
            <div class="name error">×¡×•×›×Ÿ ×œ× × ××¦×</div>
            <div class="subtitle">×‘×“×•×§ ××ª ×”×§×™×©×•×¨ ×©×§×™×‘×œ×ª ×•× ×¡×” ×©×•×‘</div>
        </div>
    </div>

    <script>
        // ============================================
        // AGENTS CONFIG - add new agents here
        // ============================================
        var AGENTS = {
            bio:       { name: "BioExpress",    subtitle: "×‘×™×• ×‘××”×™×¨×•×ª",              emoji: "âš¡", gem: "1eMUaHeB96TMO9AewHioYIz7prrniQcwa" },
            intro:     { name: "FirstImpact",   subtitle: "×¤×•×¡×˜ ×”×™×›×¨×•×ª",              emoji: "ğŸ’¥", gem: "1LinTmvBwOA9oPs4Sr5x76C49ejcpFULq" },
            groups:    { name: "GroupLink",      subtitle: "×—×™×‘×•×¨ ×œ×§×‘×•×¦×•×ª",            emoji: "ğŸ”—", gem: "1CUdYRdxB4Ehb6rPSR1D8NmUJzdL95p85" },
            friends:   { name: "NetHunter",     subtitle: "××™×ª×•×¨ ×—×‘×¨×™× ×¨×œ×•×•× ×˜×™×™×",    emoji: "ğŸ¯", gem: "1zYM8b94DnR1FfbQgXNU72ve5toAIv05B" },
            authority: { name: "AuthorityPost", subtitle: "×¤×•×¡×˜ ×‘×™×¡×•×¡ ××¢××“",          emoji: "ğŸ‘‘", gem: "1IGPtTugc5B9tBnWO4oHFgsq2ofhyaUC3" },
            launch:    { name: "LaunchCraft",   subtitle: "× ×•×¡×— ×”×©×§×ª ×©×™×¨×•×ª",           emoji: "ğŸš€", gem: "8188d71c7ff1" },
            sales:     { name: "SalesCoach",    subtitle: "××™××•×Ÿ ××›×™×¨×•×ª",              emoji: "ğŸ’°", gem: "1i3p_RvRorZaALPg8yYjqv_r-McEGhcSW" }
        };

        var params = new URLSearchParams(window.location.search);
        var agent = AGENTS[params.get('agent')];

        if (!agent) {
            document.getElementById('main').style.display = 'none';
            document.getElementById('err').style.display = 'block';
        } else {
            document.getElementById('emoji').textContent = agent.emoji;
            document.getElementById('name').textContent = agent.name;
            document.getElementById('subtitle').textContent = agent.subtitle;
            document.title = agent.name + ' - ' + agent.subtitle;

            var gemUrl = 'https://gemini.google.com/gem/' + agent.gem;
            var ua = navigator.userAgent;
            var _isAndroid = /android/i.test(ua);
            var _isIOS = /iphone|ipad|ipod/i.test(ua);
            var _isWhatsApp = /whatsapp/i.test(ua);

            // =============================================
            // STRATEGY:
            // 1. If in WhatsApp in-app browser -> auto-redirect to external browser with gem URL
            // 2. If already in external browser -> auto-redirect to gem URL directly
            // 3. Show manual buttons as fallback
            // =============================================

            if (_isWhatsApp) {
                // === WHATSAPP IN-APP BROWSER ===
                // Must escape to external browser first, then gem URL opens there
                if (_isAndroid) {
                    // Android WhatsApp: Use intent to open in Chrome with the gem URL
                    var chromeIntent = 'intent://' + gemUrl.replace('https://', '') +
                        '#Intent;' +
                        'scheme=https;' +
                        'package=com.android.chrome;' +
                        'end';
                    setTimeout(function() { window.location.href = chromeIntent; }, 600);

                    // Fallback: generic browser intent (if Chrome not installed)
                    setTimeout(function() {
                        if (!document.hidden) {
                            var genericIntent = 'intent://' + gemUrl.replace('https://', '') +
                                '#Intent;' +
                                'scheme=https;' +
                                'action=android.intent.action.VIEW;' +
                                'end';
                            window.location.href = genericIntent;
                        }
                    }, 2000);
                } else if (_isIOS) {
                    // iOS WhatsApp: Try to open in Safari
                    // Method 1: x-safari scheme
                    setTimeout(function() {
                        window.location.href = 'x-safari-' + gemUrl;
                    }, 600);
                    // Method 2: just navigate (sometimes works on iOS)
                    setTimeout(function() {
                        if (!document.hidden) {
                            window.location.href = gemUrl;
                        }
                    }, 1500);
                }

                // Show buttons after 3 seconds as fallback
                setTimeout(showButtons, 3000);

            } else {
                // === EXTERNAL BROWSER (Chrome, Safari, etc.) ===
                // Already in real browser - redirect directly to Gemini gem
                setTimeout(function() {
                    window.location.href = gemUrl;
                }, 500);

                // Show buttons after 2 seconds if still here
                setTimeout(showButtons, 2500);
            }

            // Set up button hrefs
            setupButtons(gemUrl);
        }

        function setupButtons(gemUrl) {
            var ua = navigator.userAgent;
            var _isAndroid = /android/i.test(ua);
            var _isIOS = /iphone|ipad|ipod/i.test(ua);

            // Main button - always opens gem URL directly (works great in external browser)
            document.getElementById('btn-main').href = gemUrl;

            if (_isAndroid) {
                document.getElementById('desc').textContent = 'ğŸ‘† ×œ×—×¥ ×œ×¤×ª×™×—×ª ×”×¡×•×›×Ÿ';
                document.getElementById('btn-main').textContent = 'ğŸš€ ×¤×ª×— ××ª ×”×¡×•×›×Ÿ';

                // Alt button: try to open in Chrome specifically
                var chromeIntent = 'intent://' + gemUrl.replace('https://', '') +
                    '#Intent;scheme=https;package=com.android.chrome;end';
                document.getElementById('btn-alt').href = chromeIntent;
                document.getElementById('btn-alt').textContent = 'ğŸŒ ×¤×ª×— ×‘-Chrome';

                document.getElementById('tip').textContent = 'ğŸ’¡ ×”×¡×•×›×Ÿ × ×¤×ª×— ×‘×“×¤×“×¤×Ÿ - ×©× ×”×•× ×¢×•×‘×“ ×”×›×™ ×˜×•×‘';

            } else if (_isIOS) {
                document.getElementById('desc').textContent = 'ğŸ‘† ×œ×—×¥ ×œ×¤×ª×™×—×ª ×”×¡×•×›×Ÿ';
                document.getElementById('btn-main').textContent = 'ğŸš€ ×¤×ª×— ××ª ×”×¡×•×›×Ÿ';

                // Alt button: open in Safari
                document.getElementById('btn-alt').href = gemUrl;
                document.getElementById('btn-alt').textContent = 'ğŸŒ ×¤×ª×— ×‘-Safari';

                document.getElementById('tip').textContent = 'ğŸ’¡ ×”×¡×•×›×Ÿ × ×¤×ª×— ×‘×“×¤×“×¤×Ÿ - ×©× ×”×•× ×¢×•×‘×“ ×”×›×™ ×˜×•×‘';

            } else {
                // Desktop
                document.getElementById('desc').textContent = 'ğŸ‘† ×œ×—×¥ ×œ×¤×ª×™×—×ª ×”×¡×•×›×Ÿ';
                document.getElementById('btn-main').textContent = 'ğŸš€ ×¤×ª×— ××ª ×”×¡×•×›×Ÿ';
                document.getElementById('btn-alt').style.display = 'none';
                document.getElementById('tip').textContent = '';
            }
        }

        function showButtons() {
            if (document.hidden) return; // Page left - redirect worked!
            document.getElementById('auto-state').style.display = 'none';
            document.getElementById('buttons-state').style.display = 'block';
        }
    </script>
</body>
</html>
